(function(){function e(){$(".prtermine").find("tr").has("input[type=checkbox]:checked").each(function(){var e=$(this).find("td").eq(2).text();if("nach Vereinbarung"!=e){t($(this).find("td").eq(0).text(),n($(this).find("td").eq(1).text(),$(this).find("td").eq(3).text()),e)}})}function n(e,n){var t=e.split("."),i=n.split(":");if("Â "==n||""==n){var o=t[2]+t[1]+t[0];return o}var o=t[2]+t[1]+t[0]+"T"+i[0]+i[1]+"00";return o}function t(e,n,t){var a=["BEGIN:VEVENT","DTSTART;TZID=Europe/Berlin:"+n,"DTEND;TZID=Europe/Berlin:"+n,"UID:"+o.length+"@TUHHExams","DESCRIPTION:Event added with https://github.com/KLVN/TUHH_exams2ics","LOCATION:"+t,"SUMMARY:"+e,"END:VEVENT"];return a=a.join(i),o.push(a),a}$("#main").append("<button id='dl'>Download .ics file</button>"),$("#dl").css({position:"fixed",width:"100%",bottom:"0px",left:"0",padding:"10px 50px",background:"#d00a0a",border:"0",color:"#FFF","font-size":"23px","font-family":"Arial","line-height":"30px",cursor:"pointer","z-index":"10"}),$("head").append("<style>table.prtermine tr:hover td {background-color : #2DC6D6;}</style>");var i=navigator.appVersion.indexOf("Win")!==-1?"\r\n":"\n",o=[],a=["BEGIN:VCALENDAR","VERSION:2.0","PRODID:TUHH Exams","CALSCALE:GREGORIAN"].join(i);$(".prtermine").find("tr").each(function(){var e=$(this);e.find("td").length>1&&e.append('<td><input type="checkbox" name="cb"/></td>')}),$('input[name="cb"]').click(function(){$("#dl").text("Download .ics file ("+$("input[name='cb']:checked").length+" selected)")}),$("#dl").click(function(){e();var n=i+"END:VCALENDAR",t=a+i+o.join(i)+n;filename="TUHH_Exams.ics";var d=new Blob([t],{type:"text/calendar"});if(window.navigator.msSaveOrOpenBlob)window.navigator.msSaveOrOpenBlob(d,filename);else{var r=document.createElement("a"),c=URL.createObjectURL(d);r.href=c,r.download=filename,document.body.appendChild(r),r.click(),setTimeout(function(){document.body.removeChild(r),window.URL.revokeObjectURL(c)},0)}o=[]})})();